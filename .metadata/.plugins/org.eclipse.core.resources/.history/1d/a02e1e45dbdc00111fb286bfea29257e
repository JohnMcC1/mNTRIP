package com.mntripclient;

import java.io.IOException;

import android.bluetooth.BluetoothDevice;
import android.bluetooth.BluetoothSocket;
import android.util.Log;

class ConnectThread extends Thread {
	private final BluetoothSocket mmSocket;
	private final BluetoothDevice mmDevice;

	public ConnectThread(BluetoothDevice device) {
		BluetoothSocket tmp = null;
		mmDevice = device;


		try {
			tmp = mmDevice.createRfcommSocketToServiceRecord(mNTRIPBluetoothTask.MY_UUID);
		} catch (IOException e) {
			e.printStackTrace();
		}
		
		mmSocket = tmp;
	}

	public void run() {

		try {
			mmSocket.connect();
		} catch (IOException connectException) {
			Log.e("DUPA",  connectException.getMessage());
			try {
				mmSocket.close();
			} catch (IOException closeException) {
			}
			return;
		}

		manageConnectedSocket(mmSocket);
	}

	private void manageConnectedSocket(BluetoothSocket mmSocket2) {
		try {
			byte[] buffer = {'1', '2', '3', '4', '5', '1', '2', '3', '4', '5'};
			mmSocket2.getOutputStream().write(buffer, 0, 10);
			Log.e("DUPA",  "asdasd");
			
		} catch (IOException e) {
			e.printStackTrace();
			Log.e("DUPA", e.getMessage());
		}
		
	}

	public void cancel() {
		try {
			mmSocket.close();
		} catch (IOException e) {
		}
	}
}